import { Project, DisciplineData, MonthlySpend, Status } from '../types';

// Helper function to calculate status based on utilization
export const calculateStatus = (utilization: number): Status => {
  if (utilization <= 80) return 'Healthy';
  if (utilization <= 95) return 'Caution';
  return 'Overrun';
};

// Raw project data based on your Excel file with simulated actual spending
export const projectsData: Project[] = [
  {
    id: 'PRJ-001',
    name: 'ABB LV Switchboard Retrofit',
    wbsNumber: 'P.220080001.03.0303',
    projectManager: 'Suhaimi Samijan',
    discipline: 'Electrical',
    originalBudget: 426665,
    contractValue: 380000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 426665,
    actualSpend: 285000,
    plannedSpend: 320000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2027-12-01'),
    vendor: 'ABB Malaysia',
    paymentTerms: 'Progress-based',
    projectStatus: 'Active',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-002',
    name: 'Ammoniation improvement at Urea Reactor',
    wbsNumber: null,
    projectManager: 'Tan Pin Chian',
    discipline: 'Instrument',
    originalBudget: 397527,
    contractValue: 350000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 397527,
    actualSpend: 85000,
    plannedSpend: 120000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-003',
    name: 'DCS HIS OPC EWS Replacement',
    wbsNumber: null,
    projectManager: 'Hasnul Munir',
    discipline: 'Instrument',
    originalBudget: 3665326,
    contractValue: 3200000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 3665326,
    actualSpend: 1850000,
    plannedSpend: 2400000,
    startDate: new Date('2026-01-01'),
    endDate: new Date('2027-12-01'),
    vendor: 'Yokogawa Malaysia',
    paymentTerms: 'Milestone-based',
    projectStatus: 'Planning',
    priority: 'Critical',
    remarks: null,
  },
  {
    id: 'PRJ-004',
    name: 'E-12-02-01 HEX Replacement',
    wbsNumber: null,
    projectManager: 'M Amin Zikri',
    discipline: 'Mechanical',
    originalBudget: 960000,
    contractValue: 850000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 960000,
    actualSpend: 150000,
    plannedSpend: 280000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'Medium',
    remarks: null,
  },
  {
    id: 'PRJ-005',
    name: 'E-13-06 Reformed Gas Waste Heat Boiler Replacement',
    wbsNumber: 'P.240080001.03.0210',
    projectManager: 'M Najib Ramli',
    discipline: 'Mechanical',
    originalBudget: 18800000,
    contractValue: 17500000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 18800000,
    actualSpend: 14200000,
    plannedSpend: 15000000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2027-12-01'),
    vendor: 'Mitsubishi Heavy Industries',
    paymentTerms: 'Progress-based',
    projectStatus: 'Active',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-006',
    name: 'E-18-02B-01 Replacement',
    wbsNumber: null,
    projectManager: 'M Amin Zikri',
    discipline: 'Mechanical',
    originalBudget: 2700000,
    contractValue: 2400000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 2700000,
    actualSpend: 650000,
    plannedSpend: 900000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-007',
    name: 'E-18-04 HEX Replacement',
    wbsNumber: null,
    projectManager: 'M Amin Zikri',
    discipline: 'Mechanical',
    originalBudget: 5517600,
    contractValue: 5000000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 5517600,
    actualSpend: 1200000,
    plannedSpend: 1800000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-008',
    name: 'E-19-03A HEX Replacement',
    wbsNumber: 'P.250080001.03.0209',
    projectManager: 'M Najib Ramli',
    discipline: 'Mechanical',
    originalBudget: 1560000,
    contractValue: 1400000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 1560000,
    actualSpend: 1520000,
    plannedSpend: 1450000,
    startDate: new Date('2025-12-01'),
    endDate: new Date('2027-12-01'),
    vendor: 'TPI Systems',
    paymentTerms: 'Progress-based',
    projectStatus: 'Active',
    priority: 'Critical',
    remarks: 'Near budget limit',
  },
  {
    id: 'PRJ-009',
    name: 'Fire Water Pump And Foam Panel Replacement',
    wbsNumber: null,
    projectManager: 'M Azli Yusof',
    discipline: 'Electrical',
    originalBudget: 400000,
    contractValue: 350000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 400000,
    actualSpend: 85000,
    plannedSpend: 150000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2030-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'Medium',
    remarks: null,
  },
  {
    id: 'PRJ-010',
    name: 'Ammonia Loading Arm Improvement',
    wbsNumber: 'P.250080001.03.0245',
    projectManager: 'M Amin Zikri',
    discipline: 'Mechanical',
    originalBudget: 231000,
    contractValue: 210000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 231000,
    actualSpend: 195000,
    plannedSpend: 200000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'Local Contractor',
    paymentTerms: 'Milestone-based',
    projectStatus: 'Active',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-011',
    name: 'Insurance Spares for Melamine',
    wbsNumber: 'P.250080001.03.0220',
    projectManager: 'Sharul Rizal M Zin',
    discipline: 'Melamine',
    originalBudget: 4000000,
    contractValue: 3800000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 4000000,
    actualSpend: 3650000,
    plannedSpend: 3700000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'OEM Supplier',
    paymentTerms: 'Progress-based',
    projectStatus: 'Active',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-012',
    name: 'K-11-01 Rotor Inspection and Refurbishment',
    wbsNumber: 'P.240080001.03.0203',
    projectManager: 'M Zulkifli M Zain',
    discipline: 'Rotating',
    originalBudget: 500000,
    contractValue: 450000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 500000,
    actualSpend: 420000,
    plannedSpend: 440000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'Sulzer Turbo',
    paymentTerms: 'Milestone-based',
    projectStatus: 'Active',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-013',
    name: 'K-12-01 HP Rotor Inspection and Refurbishment',
    wbsNumber: 'P.240080001.03.0204',
    projectManager: 'M Zulkifli M Zain',
    discipline: 'Rotating',
    originalBudget: 500000,
    contractValue: 480000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 500000,
    actualSpend: 510000,
    plannedSpend: 485000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'Sulzer Turbo',
    paymentTerms: 'Milestone-based',
    projectStatus: 'Active',
    priority: 'Critical',
    remarks: 'Budget overrun - additional scope',
  },
  {
    id: 'PRJ-014',
    name: 'K-12-01 LP Rotor Inspection and Refurbishment',
    wbsNumber: 'P.240080001.03.0205',
    projectManager: 'M Zulkifli M Zain',
    discipline: 'Rotating',
    originalBudget: 500000,
    contractValue: 450000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 500000,
    actualSpend: 380000,
    plannedSpend: 400000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'Sulzer Turbo',
    paymentTerms: 'Milestone-based',
    projectStatus: 'Active',
    priority: 'Medium',
    remarks: null,
  },
  {
    id: 'PRJ-015',
    name: 'KT-12-01 ACV EHPC Actuator Upgrade',
    wbsNumber: null,
    projectManager: 'A Hadi B M Yusoff',
    discipline: 'Rotating',
    originalBudget: 1167403,
    contractValue: 1050000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 1167403,
    actualSpend: 280000,
    plannedSpend: 400000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-016',
    name: 'LV Panel Protection Relay Replacement',
    wbsNumber: null,
    projectManager: 'M Farid Bahari',
    discipline: 'Electrical',
    originalBudget: 422730,
    contractValue: 380000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 422730,
    actualSpend: 95000,
    plannedSpend: 150000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-017',
    name: 'Motor Operated Valve (MOV) Replacement',
    wbsNumber: null,
    projectManager: 'M Azli Yusof',
    discipline: 'Electrical',
    originalBudget: 300000,
    contractValue: 280000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 300000,
    actualSpend: 45000,
    plannedSpend: 80000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'Critical',
    remarks: null,
  },
  {
    id: 'PRJ-018',
    name: 'HP Reactor Material Handling Equipment',
    wbsNumber: 'P.250080001.03.0501',
    projectManager: 'Sharul Rizal M Zin',
    discipline: 'Melamine',
    originalBudget: 1412500,
    contractValue: 1300000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 1412500,
    actualSpend: 1180000,
    plannedSpend: 1200000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'MHE Systems',
    paymentTerms: 'Progress-based',
    projectStatus: 'Active',
    priority: 'Medium',
    remarks: null,
  },
  {
    id: 'PRJ-019',
    name: 'Regulatory Shutdown 2026 (Operational)',
    wbsNumber: null,
    projectManager: 'Khairil Izham',
    discipline: 'TA',
    originalBudget: 1928680,
    contractValue: 1800000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 1928680,
    actualSpend: 1650000,
    plannedSpend: 1700000,
    startDate: new Date('2025-01-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'Multiple',
    paymentTerms: 'Progress-based',
    projectStatus: 'Active',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-020',
    name: 'Regulatory Shutdown 2026 (Statutory)',
    wbsNumber: 'T.2600801.S',
    projectManager: 'Khairil Izham',
    discipline: 'TA',
    originalBudget: 33530566,
    contractValue: 31000000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 33530566,
    actualSpend: 28500000,
    plannedSpend: 29000000,
    startDate: new Date('2025-01-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'Multiple',
    paymentTerms: 'Milestone-based',
    projectStatus: 'Active',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-021',
    name: 'HVAC Rejuvenation (Process & Non-process)',
    wbsNumber: null,
    projectManager: 'M Azli Yusof',
    discipline: 'Electrical',
    originalBudget: 2850000,
    contractValue: 2600000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 2850000,
    actualSpend: 2450000,
    plannedSpend: 2500000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'Daikin Malaysia',
    paymentTerms: 'Progress-based',
    projectStatus: 'Active',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-022',
    name: 'Underground Instrument Cable Replacement',
    wbsNumber: null,
    projectManager: 'Tan Pin Chian',
    discipline: 'Instrument',
    originalBudget: 720000,
    contractValue: 650000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 720000,
    actualSpend: 180000,
    plannedSpend: 250000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'Critical',
    remarks: null,
  },
  {
    id: 'PRJ-023',
    name: 'Shiploader Rejuvenation',
    wbsNumber: null,
    projectManager: 'M Farid Bahari',
    discipline: 'Electrical',
    originalBudget: 1659039,
    contractValue: 1500000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 1659039,
    actualSpend: 1250000,
    plannedSpend: 1350000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'Thyssenkrupp',
    paymentTerms: 'Milestone-based',
    projectStatus: 'Active',
    priority: 'Medium',
    remarks: null,
  },
  {
    id: 'PRJ-024',
    name: 'Siemens HV Switchgear Retrofit (VCB & VCU)',
    wbsNumber: null,
    projectManager: 'Suhaimi Samijan',
    discipline: 'Electrical',
    originalBudget: 1952640,
    contractValue: 1800000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 1952640,
    actualSpend: 1720000,
    plannedSpend: 1750000,
    startDate: new Date('2025-06-01'),
    endDate: new Date('2026-12-01'),
    vendor: 'Siemens Malaysia',
    paymentTerms: 'Progress-based',
    projectStatus: 'Active',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-025',
    name: 'Gearbox Purchase for KG-31-01',
    wbsNumber: null,
    projectManager: 'M Zulkifli M Zain',
    discipline: 'Rotating',
    originalBudget: 3250000,
    contractValue: 3000000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 3250000,
    actualSpend: 850000,
    plannedSpend: 1200000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-026',
    name: 'Turnaround 2027 (Operational)',
    wbsNumber: null,
    projectManager: 'Khairil Izham',
    discipline: 'TA',
    originalBudget: 5103660,
    contractValue: 4800000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 5103660,
    actualSpend: 1200000,
    plannedSpend: 1500000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'High',
    remarks: null,
  },
  {
    id: 'PRJ-027',
    name: 'Turnaround 2027 (Statutory)',
    wbsNumber: null,
    projectManager: 'Khairil Izham',
    discipline: 'TA',
    originalBudget: 4851952,
    contractValue: 4500000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 4851952,
    actualSpend: 980000,
    plannedSpend: 1400000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'Critical',
    remarks: null,
  },
  {
    id: 'PRJ-028',
    name: 'UPS Statron Replacement',
    wbsNumber: null,
    projectManager: 'M Azli Yusof',
    discipline: 'Electrical',
    originalBudget: 1474800,
    contractValue: 1350000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 1474800,
    actualSpend: 350000,
    plannedSpend: 500000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'Medium',
    remarks: null,
  },
  {
    id: 'PRJ-029',
    name: 'Urea Angle Valve Replacement',
    wbsNumber: null,
    projectManager: 'M Amin Zikri',
    discipline: 'Mechanical',
    originalBudget: 3000000,
    contractValue: 2750000,
    budgetTransferIn: 0,
    budgetTransferOut: 0,
    currentBudget: 3000000,
    actualSpend: 720000,
    plannedSpend: 950000,
    startDate: null,
    endDate: new Date('2027-12-01'),
    vendor: null,
    paymentTerms: null,
    projectStatus: 'Planning',
    priority: 'High',
    remarks: null,
  },
];

// Monthly spend data for trend chart
export const monthlySpendData: MonthlySpend[] = [
  { month: 'Jan 2026', planned: 8500000, actual: 7850000, cumPlanned: 8500000, cumActual: 7850000 },
  { month: 'Feb 2026', planned: 9200000, actual: 8900000, cumPlanned: 17700000, cumActual: 16750000 },
  { month: 'Mar 2026', planned: 10500000, actual: 11200000, cumPlanned: 28200000, cumActual: 27950000 },
  { month: 'Apr 2026', planned: 11000000, actual: 10650000, cumPlanned: 39200000, cumActual: 38600000 },
  { month: 'May 2026', planned: 9800000, actual: 9450000, cumPlanned: 49000000, cumActual: 48050000 },
  { month: 'Jun 2026', planned: 12500000, actual: 12950000, cumPlanned: 61500000, cumActual: 61000000 },
  { month: 'Jul 2026', planned: 8500000, actual: 0, cumPlanned: 70000000, cumActual: 61000000 },
  { month: 'Aug 2026', planned: 7800000, actual: 0, cumPlanned: 77800000, cumActual: 61000000 },
  { month: 'Sep 2026', planned: 9200000, actual: 0, cumPlanned: 87000000, cumActual: 61000000 },
  { month: 'Oct 2026', planned: 8000000, actual: 0, cumPlanned: 95000000, cumActual: 61000000 },
  { month: 'Nov 2026', planned: 5500000, actual: 0, cumPlanned: 100500000, cumActual: 61000000 },
  { month: 'Dec 2026', planned: 3282088, actual: 0, cumPlanned: 103782088, cumActual: 61000000 },
];

// Calculate discipline data from projects
export const calculateDisciplineData = (projects: Project[]): DisciplineData[] => {
  const disciplineMap = new Map<string, DisciplineData>();
  
  projects.forEach(project => {
    if (!project.discipline) return;
    
    const existing = disciplineMap.get(project.discipline);
    if (existing) {
      existing.approvedBudget += project.currentBudget;
      existing.actualSpend += project.actualSpend;
      existing.plannedSpend += project.plannedSpend;
      existing.projectCount += 1;
      existing.projects.push(project);
    } else {
      disciplineMap.set(project.discipline, {
        discipline: project.discipline,
        approvedBudget: project.currentBudget,
        actualSpend: project.actualSpend,
        plannedSpend: project.plannedSpend,
        remaining: 0,
        utilization: 0,
        variance: 0,
        status: 'Healthy',
        projectCount: 1,
        projects: [project],
      });
    }
  });
  
  // Calculate derived fields
  disciplineMap.forEach(data => {
    data.remaining = data.approvedBudget - data.actualSpend;
    data.utilization = data.approvedBudget > 0 ? (data.actualSpend / data.approvedBudget) * 100 : 0;
    data.variance = data.approvedBudget - data.actualSpend;
    data.status = calculateStatus(data.utilization);
  });
  
  return Array.from(disciplineMap.values()).sort((a, b) => b.approvedBudget - a.approvedBudget);
};

// Get all unique disciplines
export const getAllDisciplines = (): string[] => {
  const disciplines = new Set<string>();
  projectsData.forEach(project => {
    if (project.discipline) {
      disciplines.add(project.discipline);
    }
  });
  return Array.from(disciplines).sort();
};

// Department info
export const departmentInfo = {
  name: 'Maintenance & Reliability',
  costCenter: 'PCFK-MR-001',
  totalBudget: 103782088,
  fiscalYear: 2026,
  departmentHead: 'M Fairoz B A Kahar',
  budgetController: 'Siti Khadhijah Zulkafli',
  currency: 'MYR',
  lastUpdated: new Date('2026-01-19'),
};
